build_installer:
  name: 2. Compile Final Installer
  runs-on: windows-latest
  needs: [build_executable]

  steps:
  - name: â¬‡ï¸ Checkout Repository
    uses: actions/checkout@v4
      
  - name: â¬‡ï¸ Download Executable Artifact
    uses: actions/download-artifact@v4
    with:
      name: kaalen-pyinstaller-bundle
      path: .

  - name: ğŸ“ Move build into dist/Kaalen_App
    run: |
      Remove-Item -Recurse -Force dist\Kaalen_App -ErrorAction SilentlyContinue
      New-Item -ItemType Directory -Path dist\Kaalen_App | Out-Null
      Move-Item kaalen-pyinstaller-bundle\* dist\Kaalen_App
      Remove-Item -Recurse -Force kaalen-pyinstaller-bundle

  - name: âš™ï¸ Install Inno Setup Compiler
    run: choco install innosetup --no-progress

  - name: ğŸ’¾ Compile Installer (Inno Setup)
    run: '& "C:\Program Files (x86)\Inno Setup 6\ISCC.exe" "Kaalen_Installer.iss"'

  - name: ğŸš€ Upload Installer to Artifacts
    uses: actions/upload-artifact@v4
    with:
      name: Kaalen-Windows-Installer
      path: Output_Installer\Kaalen_Setup_v1.0.exe
